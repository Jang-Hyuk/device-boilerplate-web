<!DOCTYPE html>
<html>

<head>
  <!-- Default Js -->

  <%- include("../master/head.ejs") %>
  <script src="/js/contents/master/mainUtil.js"></script>
  <script src="/js/hichart/dark-unica.theme.js"></script>
  <script src="/js/contents/main/hichartMaker.js"></script>
  <%- include("./mediaQuery.ejs") %>
</head>

<body>
  <div id="wrap" class="wrap hidden">
    <!-- Header -->
    <%- include("../master/header.ejs") %>

    <!--메인-->
    <div class="containera">
      <div class="containerb text-center">
        <div class="box">
          <div class="gauge_area_m">
            <div class="deve">
              <p>발전현황</p>
              <p>Development status</p>
            </div>
            <div id="powerStatus" class="deve_1">
              <div class="stat">
                <p><I>현재출력</I></p>
                <input id="currKw" class="wed_1" style="margin-left:13px;" type="text" value="">
                <span>kW</span>
              </div>
              <div class="stat">
                <p><I>금일발전량</I></p>
                <input id="dailyPower" class="wed_1" type="text" value="">
                <span>kWh</span>
              </div>
              <div class="stat">
                <p><I>당월발전량</I></p>
                <input id="monthPower" class="wed_1" type="text" value="">
                <span>kWh</span>
              </div>
              <div class="stat">
                <p><I>누적발전량</I></p>
                <input id="cumulativePower" class="wed_1" type="text" value="">
                <span>MWh</span>
              </div>
              <!-- <div class="stat">
                <p><I>CO2저감량</I></p>
                <input id="co2" class="wed_1" type="text" value="">
                <span>Ton</span>
              </div> -->

              <img src="/image/development.jpg" width="100%" height="50%">

            </div>
          </div>
        </div>
        <div class="box_3">
          <section class="gauge_area">
            <article class="gauge_title">
              <p>현재 발전현황</p>
            </article>
            <article id="current-power-graph" class="gauge_chart">Graph</article>
            <article class="gauge_contents  border-success">
              <ul class="">
                <li>현재 출력</li>
                <li>3.72</li>
                <li>kW</li>
              </ul>
              <ul class="">
                <li>발전 효율</li>
                <li>52.1</li>
                <li>%</li>
              </ul>
            </article>
          </section>
        </div>
        <!-- <div class="box_3">
            <p style="margin-top:10px; font-weight:bold;">금일발전량</p>
            <div id="current-power-graph" style="align-self: center; width:90%; height:80%; background-color:#e9e9e9;">Graph</div>
          </div> -->
        <div class="box_3">
          <section class="gauge_area">
            <article class="gauge_title">
              <p>금일발전량</p>
            </article>
            <article id="daily-power-graph" class="gauge_chart">Graph</article>
            <article class="gauge_contents border-success">
              <ul class="">
                <li>현재 출력</li>
                <li>3.72</li>
                <li>kW</li>
              </ul>
              <ul class="">
                <li>발전 효율</li>
                <li>52.1</li>
                <li>%</li>
              </ul>
            </article>
          </section>
        </div>

        <!-- <div class="box_3">
          <section class="gauge_area">
            <article class="gauge_title">
              <p style="margin-top:10px; font-weight:bold;">금일발전량</p>
            </article>
            <div id="daily-power-graph" style="align-self: center; width:90%; height:80%; background-color:#e9e9e9;">Graph</div>
          </section>
        </div> -->



      </div>
      <div class="text-center containerc">
        <div class="box_4">
          <div class="gauge_area_m2">

            <div class="deve">
              <p>생육환경정보</p>
              <p>Growth Environment</p>
            </div>
            <div id="growthEnv" class="deve_1">
              <div class="stat">
                <p><I>일사량</I></p>
                <input id="inclinedSolar" class="wed_2" type="text" value="">
                <span>W/m²</span>
              </div>
              <div class="stat">
                <p><I>조도</I></p>
                <input id="lux" class="wed_2" type="text" value="">
                <span>lx</span>
              </div>
              <div class="stat">
                <p><I>CO2</I></p>
                <input id="co2" class="wed_2" type="text" value="">
                <span>ppm</span>
              </div>
              <div class="stat">
                <p><I>외기온도</I></p>
                <input id="outsideAirTemperature" class="wed_2" type="text" value="">
                <span>℃</span>
              </div>
              <div class="stat">
                <p><I>외기습도</I></p>
                <input id="outsideAirReh" class="wed_2" type="text" value="">
                <span>%</span>
              </div>
              <div class="stat">
                <p><I>토양온도</I></p>
                <input id="soilTemperature" class="wed_2" type="text" value="">
                <span>℃</span>
              </div>
              <div class="stat">
                <p><I>토양습도</I></p>
                <input id="soilReh" class="wed_2" type="text" value="">
                <span>%</span>
              </div>
              <div class="stat">
                <p><I>토양수분</I></p>
                <input id="soilWaterValue" class="wed_2" type="text" value="">
                <span>%</span>
              </div>
            </div>
            <!-- <div class="deve_1">
              <div class="stat">
                <p><I>기계</I></p>
                <input class="wed_1" type="text" value="정상">
              </div>
            </div> -->
          </div>
        </div>
        <div class="box_5">
          <section class="gauge_area">
            <article class="gauge_title">
              <p style="margin:10px 0;font-weight:bold;">인버터 전압/전류</p>
            </article>
            <div id="inverterStatus" class="box_5_bg">
              <div class="box_5_in">
                <!-- <div class="box_5_a" style="word-break: keep-all;
                word-wrap: break-word; padding: 5px; text-align: left">
                  <b>
                  </b>
                </div> -->
                <div class="box_5_a">
                  <b>
                  </b>
                </div>
                <div class="box_5_a">
                  <div class="box_5_in_sp">
                    <p>AC전압</p>
                  </div>
                  <div> <input class="wed_3" type="text"><span> V</span></div>
                </div>
                <div class="box_5_a">
                  <div class="box_5_in_sp">
                    <p>AC전류</p>
                  </div>
                  <div> <input class="wed_3" type="text"><span> A</span></div>
                </div>
              </div>
            </div>
          </section>
        </div>
        <div class="box_2">
          <section class="gauge_area">
            <article class="gauge_title">
              <p style="margin:10px 0; font-weight:bold;">생육 환경 현황</p>
            </article>
            <div id="growthEnvChart" style="align-self: center;width:90%; height:80%; background-color:#010304!important; margin-top: 20px;">Graph</div>
          </section>
        </div>
        <!-- <div class="box_6">
            <div class="box_6_in">
              <div class="box_6_in_4">
                <img src="/image/no1.png" />
                <p>일사량</p>
                <input id="inclinedSolar" class="wed_4" type="text" value=""><span> W/㎥</span>
              </div>
              <div class="box_6_in_4">
                <img src="/image/no2.png" />
                <p>모듈온도</p>
                <input class="wed_4" type="text" value="7.1"><span> ℃</span>
              </div>
              <div class="box_6_in_4">
                <img src="/image/no3.png" />
                <p>인버터</p>
                <input class="wed_4" type="text" value="STOP">
              </div>
              <div class="box_6_in_4">
                <img src="/image/no4.png" />
                <p>경보</p>
                <input class="wed_4" type="text" value="정상">
              </div>
            </div>
          </div> -->
      </div>
    </div>
    <!--하단1-->

    <%- include("../master/footer.ejs") %>

  </div>

  <script>
    Highcharts.theme = {
      colors: ['#2b908f', '#90ee7e', '#f45b5b', '#7798BF', '#aaeeee', '#ff0066',
        '#eeaaee', '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'
      ],
      chart: {
        backgroundColor: {
          linearGradient: {
            x1: 0,
            y1: 0,
            x2: 1,
            y2: 1
          },
          stops: [
            [0, '#2a2a2b'],
            [1, '#3e3e40']
          ]
        },
        style: {
          fontFamily: '\'Unica One\', sans-serif'
        },
        plotBorderColor: '#606063'
      },
      title: {
        style: {
          color: '#E0E0E3',
          textTransform: 'uppercase',
          fontSize: '20px'
        }
      },
      subtitle: {
        style: {
          color: '#E0E0E3',
          textTransform: 'uppercase'
        }
      },
      xAxis: {
        gridLineColor: '#707073',
        labels: {
          style: {
            color: '#E0E0E3'
          }
        },
        lineColor: '#707073',
        minorGridLineColor: '#505053',
        tickColor: '#707073',
        title: {
          style: {
            color: '#A0A0A3'

          }
        }
      },
      yAxis: {
        gridLineColor: '#707073',
        labels: {
          style: {
            color: '#E0E0E3'
          }
        },
        lineColor: '#707073',
        minorGridLineColor: '#505053',
        tickColor: '#707073',
        tickWidth: 1,
        title: {
          style: {
            color: '#A0A0A3'
          }
        }
      },
      tooltip: {
        backgroundColor: 'rgba(0, 0, 0, 0.85)',
        style: {
          color: '#F0F0F0'
        }
      },
      plotOptions: {
        series: {
          dataLabels: {
            color: '#B0B0B3'
          },
          marker: {
            lineColor: '#333'
          }
        },
        boxplot: {
          fillColor: '#505053'
        },
        candlestick: {
          lineColor: 'white'
        },
        errorbar: {
          color: 'white'
        }
      },
      legend: {
        itemStyle: {
          color: '#E0E0E3'
        },
        itemHoverStyle: {
          color: '#FFF'
        },
        itemHiddenStyle: {
          color: '#606063'
        }
      },
      credits: {
        style: {
          color: '#666'
        }
      },
      labels: {
        style: {
          color: '#707073'
        }
      },

      drilldown: {
        activeAxisLabelStyle: {
          color: '#F0F0F3'
        },
        activeDataLabelStyle: {
          color: '#F0F0F3'
        }
      },

      navigation: {
        buttonOptions: {
          symbolStroke: '#DDDDDD',
          theme: {
            fill: '#505053'
          }
        }
      },

      // scroll charts
      rangeSelector: {
        buttonTheme: {
          fill: '#505053',
          stroke: '#000000',
          style: {
            color: '#CCC'
          },
          states: {
            hover: {
              fill: '#707073',
              stroke: '#000000',
              style: {
                color: 'white'
              }
            },
            select: {
              fill: '#000003',
              stroke: '#000000',
              style: {
                color: 'white'
              }
            }
          }
        },
        inputBoxBorderColor: '#505053',
        inputStyle: {
          backgroundColor: '#333',
          color: 'silver'
        },
        labelStyle: {
          color: 'silver'
        }
      },

      navigator: {
        handles: {
          backgroundColor: '#666',
          borderColor: '#AAA'
        },
        outlineColor: '#CCC',
        maskFill: 'rgba(255,255,255,0.1)',
        series: {
          color: '#7798BF',
          lineColor: '#A6C7ED'
        },
        xAxis: {
          gridLineColor: '#505053'
        }
      },

      scrollbar: {
        barBackgroundColor: '#808083',
        barBorderColor: '#808083',
        buttonArrowColor: '#CCC',
        buttonBackgroundColor: '#606063',
        buttonBorderColor: '#606063',
        rifleColor: '#FFF',
        trackBackgroundColor: '#404043',
        trackBorderColor: '#404043'
      },

      // special colors for some of the
      legendBackgroundColor: 'rgba(0, 0, 0, 0.5)',
      background2: '#505053',
      dataLabelsColor: '#B0B0B3',
      textColor: '#C0C0C0',
      contrastTextColor: '#F0F0F3',
      maskColor: 'rgba(255,255,255,0.3)'
    };

    // Apply the theme
    Highcharts.setOptions(Highcharts.theme);

    var gaugeOption = {

      chart: {
        type: 'solidgauge'
      },

      title: null,

      pane: {
        center: ['50%', '85%'],
        size: '140%',
        startAngle: -90,
        endAngle: 90,
        background: {
          backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
          innerRadius: '60%',
          outerRadius: '100%',
          shape: 'arc'
        }
      },

      tooltip: {
        enabled: false
      },

      // the value axis
      yAxis: {
        stops: [
          [0.1, '#55BF3B'], // green
          [0.5, '#DDDF0D'], // yellow
          [0.9, '#DF5353'] // red
        ],
        lineWidth: 0,
        minorTickInterval: null,
        tickAmount: 2,
        title: {
          y: -70
        },
        labels: {
          y: 16
        }
      },

      plotOptions: {
        solidgauge: {
          dataLabels: {
            y: 5,
            borderWidth: 0,
            useHTML: true
          }
        }
      }
    };

    // The speed gauge
    var chartSpeed = Highcharts.chart('daily-power-graph', Highcharts.merge(gaugeOption, {
      yAxis: {
        min: 0,
        max: 200,
        title: {
          text: 'Speed',
          y: -90
        }
      },
      series: [{
        name: 'Speed',
        data: [80],
        dataLabels: {
          format: '<div style="text-align:center"><span style="font-size:25px;color:' +
            ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span><br/>' +
            '<span style="font-size:12px;color:silver">km/h</span></div>'
        },
        tooltip: {
          valueSuffix: ' km/h'
        }
      }]

    }));
  </script>

  <script>
    let powerGenerationInfo = <%- JSON.stringify(powerGenerationInfo) %>;
    let growthEnv = <%- JSON.stringify(growthEnv) %>;

    document.getElementById('inclinedSolar').setAttribute('value', powerGenerationInfo.inclinedSolar);

    // 발전 현황 셋팅
    setDomElementValueWithJson(document.getElementById('powerStatus'), powerGenerationInfo, 'value', 'id')
    setDomElementValueWithJson(document.getElementById('growthEnv'), growthEnv, 'value', 'id')

    $('#inverterStatus').html(<%- JSON.stringify(dom.inverterStatusListDom) %>)

    // 금일 발전량 차트
    makeGaugeChart({
      domId: 'daily-power-graph',
      yAxis: {
        min: 0,
        max: powerGenerationInfo.currKwYaxisMax * 6,
        title: ''
      },
      series: {
        name: '',
        data: 333.2,
        // data: powerGenerationInfo.dailyPower,
        tooltip: {
          valueSuffix: 'kWh'
        }
      },
    })
    // 현재 발전량 차트
    makeGaugeChart({
      domId: 'current-power-graph',
      yAxis: {
        min: 0,
        max: powerGenerationInfo.currKwYaxisMax,
        title: ''
      },
      series: {
        name: '',
        data: powerGenerationInfo.currKw,
        tooltip: {
          valueSuffix: 'kW'
        }
      },
    })

    makeColumnChart({
      domId: 'growthEnvChart',
      xAxis: {
        categories: ['토양', '외기']
      },
      yAxis: [{
          labels: {
            format: '{value} °C',
            style: {
              color: Highcharts.getOptions().colors[1]
            }
          },
          title: {
            text: '온도'
          },
          min: -10,
          max: 40,
          tickInterval: 10,
          // tickAmount: 5,
        },
        {
          labels: {
            format: '{value} %',
            style: {
              color: Highcharts.getOptions().colors[1]
            }
          },
          title: {
            text: '습도'
          },
          min: 0,
          max: 100,
          tickInterval: 20,
          // tickAmount: 5,
          opposite: 1
        }
      ],
      series: [{
          name: '온도',
          data: [growthEnv.soilTemperature, growthEnv.outsideAirTemperature],
          color: 'red',
          tooltip: {
            valueSuffix: ' °C'
          }
        },
        {
          name: '습도',
          data: [growthEnv.soilReh, growthEnv.outsideAirReh],
          yAxis: 1,
          tooltip: {
            valueSuffix: ' %'
          }
        },
        {
          name: '수분',
          data: [growthEnv.soilWaterValue],
          yAxis: 1,
          tooltip: {
            valueSuffix: ' %'
          }
        }
      ]
    })
  </script>


</body>

</html>